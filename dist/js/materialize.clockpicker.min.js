!function(){function a(a){return document.createElementNS(j,a)}function b(a){return(a<10?"0":"")+a}function c(a,b){var c=this,d=this.options,f=this.plate,g=f.offset(),h=/^touch/.test(a.type),j=g.left+s,l=g.top+s,m=(h?a.originalEvent.touches[0]:a).pageX-j,n=(h?a.originalEvent.touches[0]:a).pageY-l,q=Math.sqrt(m*m+n*n),r=!1;if(!b||!(q<t-u||q>t+u)){a.preventDefault();var v=setTimeout(function(){c.popover.addClass("clockpicker-moving")},200);k&&f.append(c.canvas);var x=!0;x=c.setHand(m,n,!b,!0),i.off(o).on(o,function(a){a.preventDefault();var b=/^touch/.test(a.type),d=(b?a.originalEvent.touches[0]:a).pageX-j,e=(b?a.originalEvent.touches[0]:a).pageY-l;(r||d!==m||e!==n)&&(r=!0,x=c.setHand(d,e,!1,!0))}),i.off(p).on(p,function(a){i.off(p),a.preventDefault();var g=/^touch/.test(a.type),h=(g?a.originalEvent.changedTouches[0]:a).pageX-j,k=(g?a.originalEvent.changedTouches[0]:a).pageY-l;(b||r)&&h===m&&k===n&&(x=c.setHand(h,k)),"hours"===c.currentView?x?60!==d.interval?c.toggleView("minutes",w/2):c.done():e(c,"invalidHour"):d.autoclose&&x?(c.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){c.done()},w/2)):x||e(c,"invalidMinute"),f.prepend(c.canvas),clearTimeout(v),c.popover.removeClass("clockpicker-moving"),i.off(o)})}}function d(a){var b=++r+"";return a?a+b:b}function e(a,b){var c=a.options[b];c&&"function"==typeof c&&!a.attachedCallBack[b]&&c.call(a.input,g.Event(b,{currentTarget:a.input[0],delegateTarget:a.input[0],namespace:"clockpicker",target:a.input[0]}),a),a.input.trigger(b+".clockpicker",a)}function f(b,f){var h=g(x),i=h.find(".clockpicker-plate"),j=h.find(".clockpicker-hours"),l=h.find(".clockpicker-minutes"),m=h.find(".clockpicker-am-pm-block"),o="INPUT"===b.prop("tagName"),p=o?b:b.find("input"),q=g("label[for="+p.attr("id")+"]"),r=this;this.id=d("cp"),this.element=b,this.options=f,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=o,this.input=p,this.label=q,this.popover=h,this.plate=i,this.hoursView=j,this.minutesView=l,this.$aHours=[],this.$aMinutes=[],this.amPmBlock=m,this.spanHours=h.find(".clockpicker-span-hours"),this.spanMinutes=h.find(".clockpicker-span-minutes"),this.spanAmPm=h.find(".clockpicker-span-am-pm"),this.footer=h.find(".picker__footer"),this.amOrPm="PM",this.attachedCallBack=[],this._parseTimeRestrictions(),p.attr("type","text"),this.spanHours.click(g.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(g.proxy(this.toggleView,this,"minutes"));var t=this.time=new Time(p.val());if(!0!==this.isValidTime(t.getHours(),t.getMinutes())&&this.input.val(""),p.on("focus.clockpicker click.clockpicker",g.proxy(this.show,this)),this.render("amPm"),this.doneBtn=g('<button type="button" class="btn-flat clockpicker-button" tabindex="'+(f.twelvehour?"3":"1")+'">'+f.donetext+"</button>").click(g.proxy(this.done,this)).appendTo(this.footer),f.darktheme&&h.addClass("darktheme"),this.render("hours"),this.render("minutes"),i.on(n,function(a){0===g(a.target).closest(".clockpicker-tick").length&&c.call(r,a,!0)}),k){var w=h.find(".clockpicker-canvas").empty(),y=a("svg");y.setAttribute("class","clockpicker-svg"),y.setAttribute("width",v),y.setAttribute("height",v);var z=a("g");z.setAttribute("transform","translate("+s+","+s+")");var A=a("circle");A.setAttribute("class","clockpicker-canvas-bearing"),A.setAttribute("cx",0),A.setAttribute("cy",0),A.setAttribute("r",2);var B=a("line");B.setAttribute("x1",0),B.setAttribute("y1",0);var C=a("circle");C.setAttribute("class","clockpicker-canvas-bg"),C.setAttribute("r",u);var D=a("circle");D.setAttribute("class","clockpicker-canvas-fg"),D.setAttribute("r",5),z.appendChild(B),z.appendChild(C),z.appendChild(D),z.appendChild(A),y.appendChild(z),w.append(y),this.hand=B,this.bg=C,this.fg=D,this.bearing=A,this.g=z,this.canvas=w}e(this,"init")}var g=window.jQuery,h=g(window),i=g(document),j="http://www.w3.org/2000/svg",k="SVGAngle"in window&&function(){var a,b=document.createElement("div");return b.innerHTML="<svg/>",a=(b.firstChild&&b.firstChild.namespaceURI)===j,b.innerHTML="",a}(),l=function(){var a=document.createElement("div").style;return"transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"OTransition"in a}(),m="ontouchstart"in window,n="mousedown"+(m?" touchstart":""),o="mousemove.clockpicker"+(m?" touchmove.clockpicker":""),p="mouseup.clockpicker"+(m?" touchend.clockpicker":""),q=navigator.vibrate?"vibrate":navigator.hasOwnProperty("webkitVibrate")?"webkitVibrate":null,r=0,s=135,t=110,u=20,v=2*s,w=l?350:1,x=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>"].join("");window.Time=function a(b){this.time=a.parse(b||"now")},Time.parse=function(a){if(a instanceof Date)return[a.getHours(),a.getMinutes()];if(Array.isArray(a))return a;if(g.isNumeric(a)){var b=new Date,c=b.getHours()+ +a;return c>23&&(c%=24),c<-23&&(c%=24),c<0&&(c=24+c),[c,b.getMinutes()]}if("string"==typeof a){if("now"===a)return Time.now();var d=/(\d{1,2}):(\d{1,2})(\s*)(AM|PM)?/gi.exec(a);return d?(d[4]&&"PM"===d[4]&&(d[1]=+d[1]+12),[+d[1],+d[2]]):[0,0]}return"Parse error"},Time.now=function(){var a=new Date;return[a.getHours(),a.getMinutes()]},Time.prototype.getHours=function(){return this.time[0]},Time.prototype.setHours=function(a){return this.time[0]=a,this},Time.prototype.isPm=function(){return this.time[0]>11},Time.prototype.getTwelveHours=function(){var a=this.time[0];return this.twelvehour&&(a>12&&(a-=12),0===a&&(a=12)),a},Time.prototype.getMinutes=function(){return this.time[1]},Time.prototype.setMinutes=function(a){return this.time[1]=a,this},Time.prototype.toString=function(){var a=this.time;return this.twelvehour?a[0]<13?b(a[0])+":"+b(a[1])+" AM":b(a[0]-12)+":"+b(a[1])+" PM":b(a[0])+":"+b(a[1])},f.DEFAULTS={default:"",fromnow:0,donetext:"Done",autoclose:!1,ampmclickable:!1,darktheme:!1,twelvehour:!0,vibrate:!0,dismissible:!0,interval:!1,min:!1,max:!1,disable:!1},f.prototype.render=function(a){var d,e,f,h,i,j=this.options,k=this,l=this.hoursView,m=this.minutesView,o=g('<div class="clockpicker-tick"></div>');if("hours"===a)for(l.empty(),this.$aHours=[],d=0;d<24;d+=1){f=o.clone(),e=d,this.$aHours.push(f),!0!==this.isValidTime(d)&&f.addClass("disabled"),h=d/6*Math.PI;var p=d>0&&d<13;j.twelvehour?(i=t,d>=12?(e=d-12,f.addClass("pm")):f.addClass("am"),0===e&&(e=12)):(i=p?80:t,p&&f.css("font-size","120%")),f.css({left:s+Math.sin(h)*i-u,top:s-Math.cos(h)*i-u}),f.html(0===e?"00":e),l.append(f),f.on(n,g.proxy(c,this))}if("minutes"===a)for(m.empty(),this.$aMinutes=[],d=0;d<60;d+=5)f=o.clone(),this.$aMinutes.push(f),!0!==this.isValidTime(null,d)&&f.addClass("disabled interval"),h=d/30*Math.PI,f.css({left:s+Math.sin(h)*t-u,top:s-Math.cos(h)*t-u}),f.css("font-size","140%"),f.html(b(d)),m.append(f),f.on(n,g.proxy(c,this));"amPm"===a&&(this.amPmBlock.empty(),this.spanAmPm.empty(),j.twelvehour?(this.hoursView.addClass("twelvehour"),j.ampmclickable?(g('<div id="click-am">AM</div>').on("click",function(){k.spanAmPm.children("#click-am").addClass("text-primary"),k.spanAmPm.children("#click-pm").removeClass("text-primary"),k.amOrPm="AM"}).appendTo(this.spanAmPm),g('<div id="click-pm">PM</div>').on("click",function(){k.spanAmPm.children("#click-pm").addClass("text-primary"),k.spanAmPm.children("#click-am").removeClass("text-primary"),k.amOrPm="PM"}).appendTo(this.spanAmPm)):(g('<button type="button" class="btn-floating btn-flat clockpicker-button am-button" tabindex="1">AM</button>').on("click",function(){k.setAMorPM("am"),k.amPmBlock.children(".pm-button").removeClass("active"),k.amPmBlock.children(".am-button").addClass("active"),k.spanAmPm.empty().append("AM")}).appendTo(this.amPmBlock),g('<button type="button" class="btn-floating btn-flat clockpicker-button pm-button" tabindex="2">PM</button>').on("click",function(){k.setAMorPM("pm"),k.amPmBlock.children(".am-button").removeClass("active"),k.amPmBlock.children(".pm-button").addClass("active"),k.spanAmPm.empty().append("PM")}).appendTo(this.amPmBlock))):this.hoursView.removeClass("twelvehour"))},f.prototype._refreshAvailable=function(a){var b=this;"hours"===a&&this.$aHours.forEach(function(a,c){!0!==b.isValidTime(c)?a.addClass("disabled"):a.removeClass("disabled")}),"minutes"===a&&this.$aMinutes.forEach(function(a,c){a.hasClass("disabled interval")||(!0!==b.isValidTime(b.time.getHours(),5*c)?a.addClass("disabled"):a.removeClass("disabled"))})},f.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},f.prototype._parseTimeRestrictions=function(){this.options.min&&!Array.isArray(this.options.min)&&(this.options.min=Time.parse(this.options.min)),this.options.max&&!Array.isArray(this.options.max)&&(this.options.max=Time.parse(this.options.max)),this.options.disable&&Array.isArray(this.options.max)&&(this.options.disable=this.options.disable.map(Time.parse))},f.prototype._optionRefresh=function(a){var b=this.options[a];return"donetext"===a&&this.doneBtn.text(b),"ampmclickable"===a&&(this.render("amPm"),this.setAMorPM(this.time.isPm()?"pm":"am")),"darktheme"===a&&(b?this.popover.addClass("darktheme"):this.popover.removeClass("darktheme")),"twelvehour"===a&&(this.render("amPm"),this.render("hours"),this.setAMorPM(this.time.isPm()?"pm":"am")),-1!==["min","max","disable","interval"].indexOf(a)&&(this._parseTimeRestrictions(),this._refreshAvailable("hours"),"minutes"===this.currentView&&this._refreshAvailable("minutes")),this},f.prototype.set=function(a,b){var c=this;g.isPlainObject(a)?g.each(a,function(a,b){c.set(a,b)}):(this.options[a]=b,this._optionRefresh(a))},f.prototype.options=function(a){var b=this;g.extend(this.options,a),g.each(a,function(a){b._optionRefresh(a)})},f.prototype.locate=function(){this.popover.show()},f.prototype.isValidTime=function(a,b){function c(a){return d.error=a,a}var d=this;if(null!==a&&void 0===b){if(this.options.min&&this.options.min[0]>a)return c("Mimimum");if(this.options.max&&this.options.max[0]<a)return c("Maximum");if(this.options.disable&&this.options.disable.some(function(b){return b[0]===a&&void 0===b[1]}))return c("Disabled time")}if(void 0!==b){if(this.options.interval&&b%this.options.interval!=0)return c("Out of interval");if(this.options.interval&&b%this.options.interval!=0)return c("Out of interval");if(this.options.disable&&this.options.disable.some(function(a){return null===a[0]&&a[1]===b}))return c("Disabled time")}if(null!==a&&void 0!==b){if(this.options.min&&(this.options.min[0]>a||this.options.min[0]===a&&this.options.min[1]>b))return c("Minimum");if(this.options.max&&(this.options.max[0]<a||this.options.min[0]===a&&this.options.max[1]<b))return c("Maximum");if(this.options.disable&&this.options.disable.some(function(c){return c[0]===a&&c[1]===b||c[0]===a&&void 0===c[1]||null===c[0]&&c[1]===b}))return c("Disabled time")}return!0},f.prototype.setAMorPM=function(a){var b=a;if(a.toUpperCase()!==this.amOrPm){var c=0;c="pm"===b?this.time.getHours()+12:this.time.getHours()-12,this.time.setHours(c)}var d="pm"===a?"am":"pm";this.hoursView.addClass(b).removeClass(d),this.options.twelvehour&&("minutes"===this.currentView&&this._refreshAvailable(this.currentView),this.amOrPm=b.toUpperCase(),this.options.ampmclickable?(this.spanAmPm.children("#click-"+b).addClass("text-primary"),this.spanAmPm.children("#click-"+d).removeClass("text-primary")):(this.amPmBlock.children("."+d+"-button").removeClass("active"),this.amPmBlock.children("."+b+"-button").addClass("active"),this.spanAmPm.empty().append(this.amOrPm)))},f.prototype.show=function(){if(!this.isShown){e(this,"beforeShow"),g(":input").each(function(){g(this).attr("tabindex",-1)});var a=this;this.input.blur(),this.popover.addClass("picker--opened"),this.input.addClass("picker__input picker__input--active"),g(document.body).css("overflow","hidden"),this.isAppended||(this.options.hasOwnProperty("container")?this.popover.appendTo(this.options.container):this.popover.insertAfter(this.input),this.setAMorPM("pm"),h.on("resize.clockpicker"+this.id,function(){a.isShown&&a.locate()}),this.isAppended=!0);var c=this.time=new Time(this.input.val()||this.options.default||"now");!0!==this.isValidTime(null,c.getMinutes())&&c.setMinutes(0),!0!==this.isValidTime(c.getHours(),c.getMinutes())&&(this.input.val(""),c.time=Time.now()),this.options.twelvehour&&(c.twelvehour=!0,c.isPm()?this.setAMorPM("pm"):this.setAMorPM("am")),this.spanHours.html(b(c.getTwelveHours())),this.spanMinutes.html(b(c.getMinutes())),this.toggleView("hours"),this.locate(),this.isShown=!0,i.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(b){var c=g(b.target);0===c.closest(a.popover.find(".picker__wrap")).length&&0===c.closest(a.input).length&&a.options.dismissible&&a.hide()}),i.on("keyup.clockpicker."+this.id,function(b){27===b.keyCode&&a.hide()}),e(this,"afterShow")}},f.prototype.hide=function(){e(this,"beforeHide"),this.input.removeClass("picker__input picker__input--active"),this.popover.removeClass("picker--opened"),g(document.body).css("overflow","visible"),this.isShown=!1,g(":input").each(function(a){g(this).attr("tabindex",a+1)}),i.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),i.off("keyup.clockpicker."+this.id),this.popover.hide(),e(this,"afterHide")},f.prototype.toggleView=function(a,b){var c=this,d=!1;"minutes"===a&&"visible"===g(this.hoursView).css("visibility")&&(e(this,"beforeHourSelect"),c._refreshAvailable(a),d=!0);var f="hours"===a,h=f?this.hoursView:this.minutesView,i=f?this.minutesView:this.hoursView;this.currentView=a,this.spanHours.toggleClass("text-primary",f),this.spanMinutes.toggleClass("text-primary",!f),i.addClass("clockpicker-dial-out"),h.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(b),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){i.css("visibility","hidden")},w),d&&e(this,"afterHourSelect")},f.prototype.resetClock=function(a){var b=this.currentView,c="hours"===b,d=c?this.time.getHours():this.time.getMinutes(),e=Math.PI/(c?6:30),f=d*e,g=c&&d>0&&d<13?80:t,h=Math.sin(f)*g,i=-Math.cos(f)*g,j=this;k&&a?(j.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){j.canvas.removeClass("clockpicker-canvas-out"),j.setHand(h,i)||j.resetHand()},a)):this.setHand(h,i)||this.resetHand()},f.prototype.resetHand=function(){this.hand.setAttribute("x2",0),this.hand.setAttribute("y2",0),this.bg.setAttribute("cx",0),this.bg.setAttribute("cy",0),this.fg.setAttribute("cx",0),this.fg.setAttribute("cy",0)},f.prototype.setHand=function(a,c,d,e){var f,h=Math.atan2(a,-c),i="hours"===this.currentView,j=Math.PI/(i||d?6:30),l=Math.sqrt(a*a+c*c),m=this.options,n=i&&l<(t+80)/2,o=n?80:t,p="";if(m.twelvehour&&(o=t),h<0&&(h=2*Math.PI+h),f=Math.round(h/j),h=f*j,i){if(m.twelvehour?("PM"===this.amOrPm&&(f+=12),12===f&&"AM"===this.amOrPm&&(f=0),24===f&&(f=12)):(12===f&&(f=0),f=n?0===f?12:f:0===f?0:f+12),!0!==this.isValidTime(f))return!1;this.time.setHours(f),p=this.time.getTwelveHours()}else{if(d&&(f*=5),60===f&&(f=0),!0!==this.isValidTime(this.time.getHours(),f))return!1;this.time.setMinutes(f),p=f}if(i?this.fg.setAttribute("class","clockpicker-canvas-fg"):f%5==0?this.fg.setAttribute("class","clockpicker-canvas-fg"):this.fg.setAttribute("class","clockpicker-canvas-fg active"),this[this.currentView]!==f&&q&&this.options.vibrate&&(this.vibrateTimer||(navigator[q](10),this.vibrateTimer=setTimeout(g.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=f,this[i?"spanHours":"spanMinutes"].html(b(p)),!k)return this[i?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var a=g(this);a.toggleClass("active",f===+a.html())}),!0;e||!i&&f%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var r=Math.sin(h)*(o-u),s=-Math.cos(h)*(o-u),v=Math.sin(h)*o,w=-Math.cos(h)*o;return this.hand.setAttribute("x2",r),this.hand.setAttribute("y2",s),this.bg.setAttribute("cx",v),this.bg.setAttribute("cy",w),this.fg.setAttribute("cx",v),this.fg.setAttribute("cy",w),!0},f.prototype.done=function(){var a=this.time;if(e(this,"beforeDone"),!0!==this.isValidTime(a.getHours(),a.getMinutes()))return void e(this,"invalidTime");this.hide(),this.label.addClass("active");var b=this.input.val(),c=a.toString();this.input.val(c),c!==b&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),e(this,"afterDone")},f.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(h.off("resize.clockpicker"+this.id),this.popover.remove())},g.fn.pickatime=function(a){var b=Array.prototype.slice.call(arguments,1),c=this.data("clockpicker");if(c&&("picker"===a||void 0===a))return c;var d;return this.each(function(){var c=g(this),e=c.data("clockpicker");e?(g.isPlainObject(a)&&e.set(a),"function"==typeof e[a]&&e[a].apply(e,b)):(d=g.extend({},f.DEFAULTS,c.data(),"object"==typeof a&&a),c.data("clockpicker",new f(c,d)))})},g.fn.pickatime.defaults=f.DEFAULTS}();